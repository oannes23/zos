<div class="groups-grid">
{% for group in groups %}
<div class="card group-card">
    <div class="card-header">
        <span class="card-title">{{ group.group | title }}</span>
        <span class="allocation">{{ (group.allocation * 100) | int }}%</span>
    </div>

    <div class="group-stats">
        <div class="stat">
            <span class="stat-value">{{ group.topic_count }}</span>
            <span class="stat-label">Topics</span>
        </div>
        <div class="stat">
            <span class="stat-value">{{ group.total_salience | round(0) | int }}</span>
            <span class="stat-label">Total Salience</span>
        </div>
    </div>

    <h4 class="mt-1">Top Topics</h4>
    <div class="mini-topic-list">
        {% for topic in group.top_topics %}
        <div class="mini-topic"
             hx-get="/ui/salience/topic/{{ topic.topic_key | urlencode }}"
             hx-target="#topic-detail-modal"
             hx-swap="innerHTML">
            <span class="topic-key truncate-text" title="{{ topic.topic_key }}">{{ topic.readable_topic_key or topic.topic_key }}</span>
            <div class="utilization-bar">
                <div class="progress">
                    <div class="progress-bar" style="width: {{ (topic.balance / topic.cap * 100) | int }}%"></div>
                </div>
                <span class="utilization-text">{{ topic.balance | round(1) }} / {{ topic.cap }}</span>
                {% if impulse_enabled and topic.impulse_balance > 0 %}
                <span class="badge badge-impulse" title="Impulse balance">{{ topic.impulse_balance | round(1) }}</span>
                {% endif %}
            </div>
        </div>
        {% else %}
        <p class="text-muted">No topics in this group</p>
        {% endfor %}
    </div>
</div>
{% endfor %}
</div>

<div id="topic-detail-modal" class="modal"></div>
